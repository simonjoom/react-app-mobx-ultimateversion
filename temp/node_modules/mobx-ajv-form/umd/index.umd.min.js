!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("_"),require("mobx"),require("Ajv")):"function"==typeof define&&define.amd?define(["_","mobx","Ajv"],t):"object"==typeof exports?exports.ReactiveForm=t(require("_"),require("mobx"),require("Ajv")):e.ReactiveForm=t(e._,e.mobx,e.Ajv)}(this,function(e,t,i){return function(e){function t(r){if(i[r])return i[r].exports;var o=i[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){var r,o,n,r,o,n;!function(a,l){o=[e,t,i(4)],r=l,n="function"==typeof r?r.apply(t,o):r,!(void 0!==n&&(e.exports=n))}(this,function(e,t){!function(a,l){o=[e,t,i(4)],r=l,n="function"==typeof r?r.apply(t,o):r,!(void 0!==n&&(e.exports=n))}(this,function(e,t,i){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(i);t["default"]=o["default"],e.exports=t["default"]})})},function(t,i){t.exports=e},function(e,i){e.exports=t},function(e,t,i){var r,o,n,r,o,n;!function(a,l){o=[e,t,i(2),i(1)],r=l,n="function"==typeof r?r.apply(t,o):r,!(void 0!==n&&(e.exports=n))}(this,function(e,t){!function(a,l){o=[e,t,i(2),i(1)],r=l,n="function"==typeof r?r.apply(t,o):r,!(void 0!==n&&(e.exports=n))}(this,function(e,t,i,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t,i,r){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t,i,r,o){var n={};return Object.keys(r).forEach(function(e){n[e]=r[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce(function(i,r){return r(e,t,i)||i},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var u,c,d,p,f,v,h=o(r),y=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),b=(u=function(){function e(t){var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];l(this,e),a(this,"$value",c,this),a(this,"$valid",d,this),a(this,"interacted",p,this),a(this,"disabled",f,this),a(this,"errorMessage",v,this),this.silent=null,this.originalValue=null,this.originalErrorMessage=null,this.validateProperty=null,this.validationFunctionsValues=[],this.initField(t,i,r)}return y(e,[{key:"initField",value:function(e,t,r){var o=this;if(this.key=e,h["default"].forEach(r,function(e,t){o[t]=e}),h["default"].isBoolean(t)||h["default"].isArray(t)||h["default"].isString(t)||h["default"].isNumber(t))return this.name=e,this.label=e,this.$value=t,void(this.originalValue=t);if(h["default"].isObject(t)){var n=t.value,a=t.name,l=t.label,s=t.disabled,u=t.message,c=t.validate,d=t.related;return this.$value=n||"",this.originalValue=n||"",this.name=a||e,this.label=l||e,this.originalErrorMessage=u,this.validateProperty=(0,i.toJS)(c)||null,this.disabled=s||!1,void(this.related=d||[])}throw new Error("\n      The field "+this.key+" should be an object\n      , an array, a boolean, a string or a number.\n    ")}},{key:"getValue",value:function(){return this.$value}},{key:"setValue",value:function(e){this.interacted||(this.interacted=!0),this.$value!==e&&(this.$value=e)}},{key:"clear",value:function(){h["default"].isBoolean(this.$value)||(h["default"].isString(this.$value)&&(this.$value=""),this.interacted=!1,this.setInvalid(!1),this.silent=!0)}},{key:"reset",value:function(){h["default"].isBoolean(this.$value)||(this.$value=this.originalValue),this.interacted=!1,this.setInvalid(!1)}},{key:"update",value:function(e){this.setValue(e)}},{key:"setValid",value:function(){this.$valid=!0,this.errorMessage=null}},{key:"setInvalid",value:function(){var e=arguments.length<=0||void 0===arguments[0]||arguments[0];h["default"].isBoolean(this.$value)||(this.$valid=!1),this.errorMessage=e?this.originalErrorMessage:null}},{key:"setInvalidWithMessage",value:function(e){var t=arguments.length<=1||void 0===arguments[1]||arguments[1];this.$valid=!1,this.errorMessage=t?e:null}},{key:"validate",value:function(){var e=(!(arguments.length<=0||void 0===arguments[0])&&arguments[0],arguments.length<=1||void 0===arguments[1]||arguments[1]),t=arguments.length<=2||void 0===arguments[2]?null:arguments[2];return t&&(this.form=t),this.silent===!0?void(this.silent=!1):this.validateProperty||this.form.ajv?(this.form.ajv&&this.handleAjvValidationRules(e),void(this.validateProperty&&this.handleValidateProperty(e))):void this.setValid()}},{key:"handleAjvValidationRules",value:function(e){var t=this,i=this.form.ajv,r=i(n({},this.name,this.$value));if(!r){var o=h["default"].find(i.errors,function(e){return h["default"].includes(e.dataPath,"."+t.name)});if(!h["default"].isUndefined(o)){var a=this.label+" "+o.message;return void this.setInvalidWithMessage(a,e)}}this.setValid()}},{key:"handleValidateProperty",value:function(e){var t=this;this.validationFunctionsValues=[];var r=(0,i.toJS)(this.validateProperty);if(h["default"].isFunction(r)){var o=this.handleValidateFunction(r,e);this.validationFunctionsValues.push({valid:o[0],message:o[1]})}h["default"].isArray(r)&&h["default"].forEach(r,function(e){if(h["default"].isFunction(e)){var i=t.handleValidateFunction(e);t.validationFunctionsValues.push({valid:i[0],message:i[1]})}});var n=this.checkValidateFunctions();return n&&this.$valid?void this.setValid():void(n||h["default"].forEach(this.validationFunctionsValues,function(i){if(i.valid===!1)return void t.setInvalidWithMessage(i.message,e)}))}},{key:"handleValidateFunction",value:function(e){var t=e(this,this.form.fields);if(h["default"].isArray(t)){var i=t[0]||!1,r=t[1]||"Error";return[i,r]}return h["default"].isBoolean(t)?[t,"Error"]:[!1,"Error"]}},{key:"checkValidateFunctions",value:function(){return h["default"].every(this.validationFunctionsValues,"valid")}},{key:"isValid",get:function(){return this.$valid}},{key:"isDirty",get:function(){var e=this.originalValue!==this.$value;return e||this.interacted}},{key:"value",get:function(){return(0,i.isObservableArray)(this.$value)?[].slice.call(this.$value):this.$value}}]),e}(),c=s(u.prototype,"$value",[i.observable],{enumerable:!0,initializer:null}),d=s(u.prototype,"$valid",[i.observable],{enumerable:!0,initializer:function(){return!1}}),p=s(u.prototype,"interacted",[i.observable],{enumerable:!0,initializer:function(){return!1}}),f=s(u.prototype,"disabled",[i.observable],{enumerable:!0,initializer:function(){return!1}}),v=s(u.prototype,"errorMessage",[i.observable],{enumerable:!0,initializer:function(){return null}}),s(u.prototype,"initField",[i.action],Object.getOwnPropertyDescriptor(u.prototype,"initField"),u.prototype),s(u.prototype,"isValid",[i.computed],Object.getOwnPropertyDescriptor(u.prototype,"isValid"),u.prototype),s(u.prototype,"isDirty",[i.computed],Object.getOwnPropertyDescriptor(u.prototype,"isDirty"),u.prototype),s(u.prototype,"value",[i.computed],Object.getOwnPropertyDescriptor(u.prototype,"value"),u.prototype),s(u.prototype,"setValue",[i.action],Object.getOwnPropertyDescriptor(u.prototype,"setValue"),u.prototype),s(u.prototype,"clear",[i.action],Object.getOwnPropertyDescriptor(u.prototype,"clear"),u.prototype),s(u.prototype,"reset",[i.action],Object.getOwnPropertyDescriptor(u.prototype,"reset"),u.prototype),s(u.prototype,"update",[i.action],Object.getOwnPropertyDescriptor(u.prototype,"update"),u.prototype),s(u.prototype,"setValid",[i.action],Object.getOwnPropertyDescriptor(u.prototype,"setValid"),u.prototype),s(u.prototype,"setInvalid",[i.action],Object.getOwnPropertyDescriptor(u.prototype,"setInvalid"),u.prototype),s(u.prototype,"setInvalidWithMessage",[i.action],Object.getOwnPropertyDescriptor(u.prototype,"setInvalidWithMessage"),u.prototype),s(u.prototype,"validate",[i.action],Object.getOwnPropertyDescriptor(u.prototype,"validate"),u.prototype),s(u.prototype,"handleAjvValidationRules",[i.action],Object.getOwnPropertyDescriptor(u.prototype,"handleAjvValidationRules"),u.prototype),u);t["default"]=b,e.exports=t["default"]})})},function(e,t,i){var r,o,n,r,o,n;!function(a,l){o=[e,t,i(2),i(3),i(5),i(1)],r=l,n="function"==typeof r?r.apply(t,o):r,!(void 0!==n&&(e.exports=n))}(this,function(e,t){!function(a,l){o=[e,t,i(2),i(3),i(5),i(1)],r=l,n="function"==typeof r?r.apply(t,o):r,!(void 0!==n&&(e.exports=n))}(this,function(e,t,i,r,o,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function l(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function s(e,t,i,r){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t,i,r,o){var n={};return Object.keys(r).forEach(function(e){n[e]=r[e]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=i.slice().reverse().reduce(function(i,r){return r(e,t,i)||i},n),o&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(o):void 0,n.initializer=void 0),void 0===n.initializer&&(Object.defineProperty(e,t,n),n=null),n}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=void 0;var d,p,f,v,h,y=a(r),b=a(o),g=a(n),m=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),j=(d=function(){function e(t){var i=t.fields,r=void 0===i?{}:i,o=t.schema,n=void 0!==o&&o,a=t.options,l=void 0===a?{}:a,c=t.extend,d=void 0===c?null:c;u(this,e),this.schema=null,this.options=null,this.extend=null,this.ajv=null,s(this,"fields",p,this),s(this,"validating",f,this),s(this,"genericErrorMessage",v,this),s(this,"syncValue",h,this),this.fields=r,this.schema=n,this.options=l,this.extend=d,this.mergeSchemaDefaults(),this.initAjv(),this.initFields(),this.validateFields(!1,!1),this.observeFields()}return m(e,[{key:"mergeSchemaDefaults",value:function(){var e=this;0===Object.keys(this.fields).length&&this.schema&&Object.keys(this.schema.properties).forEach(function(t){var i=e.schema.properties[t].title,r=e.schema.properties[t]["default"];e.fields[t]={label:i,value:r}})}},{key:"initFields",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],i=this.fieldKeys();i.forEach(function(i){return g["default"].merge(e.fields,l({},i,new y["default"](i,e.fields[i],t)))})}},{key:"initAjv",value:function(){if(this.schema){var e=new b["default"](g["default"].merge(this.options,{allErrors:!0,coerceTypes:!0,v5:!0}));this.extend&&g["default"].forEach(this.extend,function(t,i){return e.addKeyword(i,t)}),this.ajv=e.compile(this.schema)}}},{key:"observeFields",value:function(){var e=this;g["default"].forEach(this.fields,function(t,r){return(0,i.observe)(e.fields[r],"$value",function(){return e.validateField(r,!0)})})}},{key:"validateFields",value:function(){var e=this,t=arguments.length<=0||void 0===arguments[0]||arguments[0],i=arguments.length<=1||void 0===arguments[1]||arguments[1];g["default"].forEach(this.fields,function(r){return r.validate(t,i,e)})}},{key:"validateField",value:function(){var e=arguments.length<=0||void 0===arguments[0]?null:arguments[0],t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1],i=this,r=arguments.length<=2||void 0===arguments[2]||arguments[2],o=arguments.length<=3||void 0===arguments[3]||arguments[3];if(!e)throw new Error("validateField: No field key provided");if(this.fields[e].validate(r,o,this),t){var n=this.fields[e].related;g["default"].isEmpty(n)||g["default"].forEach(n,function(e){return i.validateField(e)})}}},{key:"fieldKeys",value:function(){return Object.keys(this.fields)}},{key:"values",value:function(){return g["default"].mapValues(this.fields,"value")}},{key:"clear",value:function(){var e=this;this.fieldKeys().forEach(function(t){return e.fields[t].clear()}),this.genericErrorMessage=null}},{key:"reset",value:function(){var e=this;g["default"].forEach(this.fields,function(t,i){return e.fields[i].reset()}),this.genericErrorMessage=null}},{key:"update",value:function(e){var t=this;g["default"].forEach(e,function(e,i){return t.fields[i].update(e)})}},{key:"validate",value:function(){return!this.validating&&(this.validateFields(),!!this.checkGenericAjvValidation()&&this.isValid)}},{key:"checkGenericAjvValidation",value:function(){if(this.validating=!0,this.genericErrorMessage=null,this.ajvValidate){var e=this.ajvValidate,t=e(this.values());if(!t)return this.genericErrorMessage="An error occurred. Validation has failed.",this.validating=!1,!1}return this.validating=!1,!0}},{key:"invalidate",value:function(e){return g["default"].isString(e)?void(this.genericErrorMessage=e):void(this.genericErrorMessage="An error occurred sending request.")}},{key:"isValid",get:function(){return!this.validating&&g["default"].every(this.fields,"isValid")}},{key:"isDirty",get:function(){var e=this;return this.fieldKeys().some(function(t){return e.fields[t].isDirty})}}]),e}(),p=c(d.prototype,"fields",[i.observable],{enumerable:!0,initializer:function(){return{}}}),f=c(d.prototype,"validating",[i.observable],{enumerable:!0,initializer:function(){return!1}}),v=c(d.prototype,"genericErrorMessage",[i.observable],{enumerable:!0,initializer:function(){return null}}),c(d.prototype,"mergeSchemaDefaults",[i.action],Object.getOwnPropertyDescriptor(d.prototype,"mergeSchemaDefaults"),d.prototype),c(d.prototype,"initFields",[i.action],Object.getOwnPropertyDescriptor(d.prototype,"initFields"),d.prototype),c(d.prototype,"initAjv",[i.action],Object.getOwnPropertyDescriptor(d.prototype,"initAjv"),d.prototype),c(d.prototype,"observeFields",[i.action],Object.getOwnPropertyDescriptor(d.prototype,"observeFields"),d.prototype),c(d.prototype,"isValid",[i.computed],Object.getOwnPropertyDescriptor(d.prototype,"isValid"),d.prototype),c(d.prototype,"isDirty",[i.computed],Object.getOwnPropertyDescriptor(d.prototype,"isDirty"),d.prototype),c(d.prototype,"clear",[i.action],Object.getOwnPropertyDescriptor(d.prototype,"clear"),d.prototype),c(d.prototype,"reset",[i.action],Object.getOwnPropertyDescriptor(d.prototype,"reset"),d.prototype),c(d.prototype,"update",[i.action],Object.getOwnPropertyDescriptor(d.prototype,"update"),d.prototype),c(d.prototype,"validate",[i.action],Object.getOwnPropertyDescriptor(d.prototype,"validate"),d.prototype),c(d.prototype,"checkGenericAjvValidation",[i.action],Object.getOwnPropertyDescriptor(d.prototype,"checkGenericAjvValidation"),d.prototype),h=c(d.prototype,"syncValue",[i.action],{enumerable:!0,initializer:function(){var e=this;return function(t){var i=e.fields[t.target.name].value;return g["default"].isBoolean(i)&&g["default"].isBoolean(t.target.checked)?void e.fields[t.target.name].setValue(t.target.checked):void e.fields[t.target.name].setValue(t.target.value)}}}),c(d.prototype,"invalidate",[i.action],Object.getOwnPropertyDescriptor(d.prototype,"invalidate"),d.prototype),d);t["default"]=j,e.exports=t["default"]})})},function(e,t){e.exports=i}])});
//# sourceMappingURL=index.umd.min.js.map